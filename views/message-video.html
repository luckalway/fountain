
<!DOCTYPE html>
<html lang=en>
<head>
<meta name=viewport
	content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
<meta charset=UTF-8>
<meta name=format-detection content="telephone=no, email=no">
<title><%=message.title%>(<%=currentPart.partNo%>/<%=message.countOfParts%>)</title>
<link href="/framework/videojs/video-js.css" rel="stylesheet">
<% include include/script.html %>

<style type="text/css">
.video-js .vjs-big-play-button {
	top: 50%;
	left: 50%;
}
</style>

</head>
<body>
	<div class="container col-sm-12 col-md-10 col-md-offset-1">
		<div class="videos-container col-sm-12 col-md-12" style="margin-top: 30px;">
			<% if(currentPart.preview!=null){ %>
			<video id="message-video" style="height: auto;position: relative;" poster="<%=currentPart.preview.url%>" class="video-js vjs-default-skin col-sm-12" controls="controls">
				<source src="<%=currentPart.video.url%>" type="video/mp4" />
				<source src="<%=currentPart.video.url%>" type="video/webm" />
				<source src="<%=currentPart.video.url%>" type="video/ogg" />
				您的浏览器不支持 video标签。
			</video>
			<%} else { %>
			<video id="message-video" style="height: auto;position: relative;" class="video-js vjs-default-skin col-sm-12" controls="controls">
				<source src="<%=currentPart.video.url%>" type="video/mp4" />
				<source src="<%=currentPart.video.url%>" type="video/webm" />
				<source src="<%=currentPart.video.url%>" type="video/ogg" />
				您的浏览器不支持 video标签。
			</video>
			<% } %>
		</div>
		<div class="clear"></div>
		<br>
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">视频列表</h3>
			</div>
			<div class="panel-body">
				<ul class="list-group">
				  <%for (var i=0;i<messageParts.length ;i++){%>	
				  <li class="list-group-item <%if(messageParts[i]._id == currentPart._id){%>active<%}%>" data-video-src="<%=messageParts[i].video.url%>">
				  	<%=message.title%>(<%=messageParts[i].partNo%>/<%=message.countOfParts%>)
				  	<div style="float: right;">
				  	</div>	
				  </li>
				  <% } %>
				</ul>
			</div>
		</div>
	</div>
	<script src="/framework/videojs/video.js"></script>
	<script type="text/javascript">
	var player = videojs('message-video');
	player.ready(function(){
		$(".list-group-item").click(function(){
			if($(this).hasClass('active')&&!player.paused())
				return false;
			
			player.pause();
			$(".list-group-item").removeClass('active');
			$(this).addClass('active');
			
			player.src([
	            {type: "video/mp4", src: $(this).data('video-src')},
	            {type: "video/webm", src: $(this).data('video-src')},
	            {type: "video/ogg", src: $(this).data('video-src')}
			]);
		});
		
	});
</script>
</body>

</html>